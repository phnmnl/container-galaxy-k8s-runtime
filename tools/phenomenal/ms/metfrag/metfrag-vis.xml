<?xml version='1.0' encoding='UTF-8'?>
<!--This is a configuration file for the integration of a tools into Galaxy (https://galaxyproject.org/).-->
<!--Proposed Tool Section: [PhenoMeNal]-->
<tool id="metfrag-vis" name="metfrag-vis" version="0.5">
  <description>Generate a PDF summary for MetFrag result files</description>
  <command><![CDATA[
  	mkdir /tmp/outputdir/;
        bash /usr/local/bin/visualize-metfrag.sh $metfrag_vis_input_1 /tmp/outputdir/combined_top1_cands.csv $metfrag_vis_input_2;
        java -Xmx2048m -Xms256m -jar /usr/local/bin/ConvertMetFragCSV.jar csv=/tmp/outputdir/combined_top1_cands.csv output=/tmp/outputdir/combined_top1_cands.tex propertyWhiteList=Score,SampleName,Identifier,MolecularFormula,CompoundName,NumberPeaksUsed,NoExplPeaks,MetFragWebURL format=tex;
        pdflatex -output-directory /tmp/outputdir/ /tmp/outputdir/combined_top1_cands.tex;
        mv /tmp/outputdir/combined_top1_cands.pdf $metfrag_vis_output_1;
        rm -rf /tmp/outputdir/;
        rm /tmp/*.png;
  ]]>
  </command>
  <inputs>
    <param name="metfrag_vis_input_1" type="data" format="csv" multiple="True" optional="False" label="MetFrag result files" />
    <param name="metfrag_vis_input_2" type="data" format="txt" multiple="True" optional="True" label="MetFrag parameter files" />
  </inputs>
  <outputs>
	<data name="metfrag_vis_output_1" type="data" format="pdf" label="Summary PDF file" />	
  </outputs>
  <help>

.. class:: infomark

| **Tool update: See the 'NEWS' section at the bottom of the page**

---------------------------------------------------

.. class:: infomark

**Authors**

| **Christoph Ruttkies (christoph.ruttkies@ipb-halle.de)** wrote and maintains this wrapper for the generation of a MetFrag summary file.

---------------------------------------------------

=====================
MetFrag-Visualization
=====================

-----------
Description
-----------

| This module is used generate a summary PDF file from a MetFrag result file collection. The results are usually generated by the **metfrag-cli-batch**. The generated PDF file includes the Top1 entries of each result CSV file including an image of the candidate and properties. Optionally, the previously generated parameter files can be used as input to create query URLs for the MetFrag-Web tool.

+-------------------+
| predecessor tool  |
+-------------------+
| metfrag-cli-batch |
| msms2metfrag      |
+-------------------+

-----------
Input files
-----------

+------------------------------+------------+
| File                         |   Format   |
+==============================+============+
| 1)  MetFrag result file      |    csv     |
|     collection               |            |
+------------------------------+------------+
| 2)  MetFrag parameter file   |    txt     |
|     collection               |            |
+------------------------------+------------+

----------
Parameters
----------

MetFrag result file collection
        | Collection of CSV files containing MetFrag results generated by **metfrag-cli-batch**
        |

MetFrag parameter file collection
	| Collection of TXT files containing MetFrag parameters generated by **msms2metfrag**
	|

------------
Output files
------------

metfrag_vis_output_1
        | Summary PDF file visualizing MetFrag results
        |

---------------------------------------------------

----
NEWS
----

CHANGES IN VERSION 0.5
========================

- changes help and description

CHANGES IN VERSION 0.4
========================

- added help and description

CHANGES IN VERSION 0.3
========================

- fixed bugs when empty result files are passed

CHANGES IN VERSION 0.1
========================

- First version

  </help>
</tool>
