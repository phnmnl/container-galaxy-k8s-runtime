<?xml version='1.0' encoding='UTF-8'?>
<tool id="isa_get_study_factor_values" name="Get values of a study factor"
      version="1.0">
    <description>
        Get list of factor values for given factor used in a MetaboLights study
    </description>

    <stdio>
        <exit_code range="1:" level="fatal"/>
    </stdio>
    <command><![CDATA[
        run_mtblisa.py get-factor-values "${mtbls_id}" "${factor}" "${output}"
]]>
    </command>
    <inputs>
        <param name="mtbls_id" type="text"
               label="MetaboLights Study Identifier."
               help="MTBLS ID available at MetaboLights, e.g. MTBLS2."/>
        <param name="factor" type="text" label="Factor name."
               help="Factor value relevant to the specified MetaboLights study, e.g. cyp79. You can get a study's factor values by using the study_factor_values tool."/>
    </inputs>
    <outputs>
        <data format="json" name="output"
              label="$(mtbls_id) $(factor) factor values list"/>
    </outputs>

    <tests>
        <test>
            <param name="mtbls_id" value="MTBLS1"/>
            <param name="factor" value="Gender"/>
            <output name="output" file="mtbls1_factor_values_out.json" compare="sim_size"/>
        </test>
    </tests>

    <help>
<!-- @@@BEGIN_RST@@@ -->
==================================================
Get list of study factors for a MetaboLights study
==================================================

This tool gets the list of factor values from a MetaboLights study for a
given study factor name. It extracts the factor values from the ISA-Tab
study and assay tables for the MetaboLights study.

-----
Input
-----

MetaboLights Study Identifier
=============================
MTBLS ID available at MetaboLights, e.g. MTBLS2.

Factor name
===========
A factor name from the list of factors in the study metadata. You can
get the relevant factor names for a particular study by using the
`study_factors` tool.

------
Output
------

List of factor values as JSON
=============================

A list of factor values for the specified factor name as a JSON list.
e.g.

::
    ["Exp2", "Exp1"]

<!-- @@@END_RST@@@ -->
    </help>

    <citations>
        <citation type="doi">10.1093/nar/gks1004</citation>
        <citation type="doi">10.5281/zenodo.163640</citation>
        <citation type="doi">10.1038/ng.1054</citation>
    </citations>

</tool>
