<tool id="mtbls-factors-viz" name="MetaboLights Factors Viz" version="0.3">
<stdio>
<exit_code range="1:" />
</stdio>
<description>Visualizes factors and its values on ISA-Tab and MetaboLights factors JSON</description>
<command><![CDATA[
#if $input_type_conditional.input_type == "mtbls-id"
  makeParallelCoordsPlot.R -s "$input_type_conditional.mtbls_id" -o \$PWD
#else  
  makeParallelCoordsPlot.R -i "$input_type_conditional.factors_json" -o \$PWD
#end if

]]></command>
<!-- -p, -l -s are optional; tracing data, time and experimental factor are required
 Missing -q quick mode.
 -->
<inputs>
    <conditional name="input_type_conditional">
            <param name="input_type" type="select" label="Input Type">
                <option value="mtbls-id" selected="true">MetaboLights Study Identifier</option>
                <option value="isa-factors-json">ISA-tab Factors table as JSON file</option>
            </param>
            <when value="mtbls-id">
                 <param name="mtbls_id" type="text" label="MetaboLights Study Identifier" help="MTBLS ID available at MetaboLights Parallel Coordinates at ftp://ftp.ebi.ac.uk/pub/databases/metabolights/derived/parallel_coordinates/"/>
            </when>
            <when value="isa-factors-json">
	         <param type="data" name="factors_json" format="json" label="ISA-tab factors table in JSON format" />
	    </when>
        </conditional>	
    </inputs>
<outputs>
    <data name="factors_plot" format="pdf" from_work_dir="factors_plot.pdf" label="Factors Parallel Sets Plot"/>
</outputs>
<help>
<!-- @@@BEGIN_RST@@@ -->

=========================================
Visualize ISA-Tab files from MetaboLights
=========================================

This tool generates a visualization from ISA-Tab metadata files from MetaboLights.

The visualization is a parallel sets plot of the study's factor values used against the number of samples, giving an overview of the study factors and their relationship.

-----
Input
-----
MetaboLights Study Identifier
=============================
MTBLS ID available at MetaboLights, e.g. MTBLS2.

OR

ISA-tab factors table in JSON format
====================================
Factors table as generated by `factors_summary` tool.

------
Output
------

Parallel sets factors visualization
===================================
Factors parallel sets plot as a PDF.

<!-- @@@END_RST@@@ -->
</help>

<citations>
    <citation type="doi">10.1093/nar/gks1004</citation>
    <citation type="doi">10.5281/zenodo.163640</citation>
    <citation type="doi">10.1038/ng.1054</citation>
</citations>

</tool>
